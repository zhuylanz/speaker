<!DOCTYPE html>
<html>
<head>
	<title>Nuhula Speaker</title>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
</head>
<body>
	<textarea style="width: 500px; height: 300px; overflow: auto; margin: auto;"></textarea>
	<input type="button" class="trigger" value="Speak" onclick="speakText()">
	<script>
		let speakText = function() {
			let text = $('textarea').val();
			$.ajax({
				method: 'POST',
				url: '/speak',
				data: { text: text },
				success: async function(data) {
					console.log(data);
					for (var i in data) {
						$('body').append('<audio style="display: none;" controls><source id="source" src="'+data[i]+'?dynamic='+Math.random()+'" type="audio/mpeg"/></audio>');
					}
					$('audio').on('ended', function() {
						alert(this);
						console.log(this);
					});
					setTimeout(() => {
						$('audio').get(0).play();
					}, 500);
				}
			});
		}

	</script>
</body>
</html>
